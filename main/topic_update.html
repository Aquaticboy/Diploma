<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>

<a href="./edit_created_topics.html" style="margin: 10px; display: inline-block;">
    <i class="bi bi-arrow-left-square-fill"></i>
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-arrow-left-square-fill" viewBox="0 0 16 16">
        <path d="M16 14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2zm-4.5-6.5H5.707l2.147-2.146a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708-.708L5.707 8.5H11.5a.5.5 0 0 0 0-1"/>
    </svg>
</a>
<h1 class="text-center">Створення теми</h1>
<form id="topicForm">
    <div class="container">
        <div class="row">
          <div class="col-sm">
            <label for="" class="form-label">Назва теми</label>
            <input type="text" class="form-control" id="form-topic-name" placeholder=""/>
          </div>
        </div>
        <div class="row">
            <div class="col-sm">
              <label for="" class="form-label">Опис теми</label>
              <input type="text" class="form-control" id="form-topic-description" placeholder=""/>
            </div>
          </div>
          <div class="row">
            <div class="col-sm">
              <label for="" class="form-label">Основна інформація теми</label>
              <textarea class="form-control" name="" id="form-topic-main-information" rows="13"></textarea>
          </div>
        </div>
      </div>
    
      <br><hr><br>
      <h1 class="text-center">Створення тестування для теми</h1>
      <div class="container">
        <div class="row">
          <div class="col-sm">
            <label for="" class="form-label">Питання №1</label>
            <input type="text" class="form-control" id="form-question1" placeholder=""/>
          </div>
          <div class="col-sm">
            <label for="" class="form-label">Відповідь до питання №1</label>
            <input type="text" class="form-control" id="form-answer1" placeholder=""/>
          </div>
        </div>
        <div class="row">
            <div class="col-sm">
              <label for="" class="form-label">Питання №2</label>
              <input type="text" class="form-control" id="form-question2" placeholder=""/>
            </div>
            <div class="col-sm">
              <label for="" class="form-label">Відповідь до питання №2</label>
              <input type="text" class="form-control" id="form-answer2" placeholder=""/>
            </div>
          </div>
          <div class="row">
            <div class="col-sm">
              <label for="" class="form-label">Питання №3</label>
              <input type="text" class="form-control" id="form-question3" placeholder=""/>
            </div>
            <div class="col-sm">
              <label for="" class="form-label">Відповідь до питання №3</label>
              <input type="text" class="form-control" id="form-answer3" placeholder=""/>
            </div>
          </div>
          <div class="row">
            <div class="col-sm">
              <label for="" class="form-label">Питання №4</label>
              <input type="text" class="form-control" id="form-question4" placeholder=""/>
            </div>
            <div class="col-sm">
              <label for="" class="form-label">Відповідь до питання №4</label>
              <input type="text" class="form-control" id="form-answer4" placeholder=""/>
            </div>
          </div>
          <div class="row">
            <div class="col-sm">
              <label for="" class="form-label">Питання №5</label>
              <input type="text" class="form-control" id="form-question5" placeholder=""/>
            </div>
            <div class="col-sm">
              <label for="" class="form-label">Відповідь до питання №5</label>
              <input type="text" class="form-control" id="form-answer5" placeholder=""/>
            </div>
          </div>
          <div class="row">
            <div class="col-sm">
              <label for="" class="form-label">Питання №6</label>
              <input type="text" class="form-control" id="form-question6" placeholder=""/>
            </div>
            <div class="col-sm">
              <label for="" class="form-label">Відповідь до питання №6</label>
              <input type="text" class="form-control" id="form-answer6" placeholder=""/>
            </div>
          </div>
      </div>
      <br>
      <button type="submit" style="margin-left: 40%; margin-right: 35%; margin-top: 10px;" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">Підтвердити створення теми та тестування</button>
</form>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Успішно</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="window.location.href = './topics_list_page.html';"></button>
            </div>
            <div class="modal-body">
                Тема та тестування успішно оновлено!
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="window.location.href = './topics_list_page.html';">Завершити</button>
            </div>
        </div>
    </div>
</div>

<br>

<script>
    document.getElementById('topicForm').addEventListener('submit', function(event) {
        event.preventDefault();
        createTopicAndTest();
    });

    function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    function createTopicAndTest() {
        var topic_id = getParameterByName("topicId");

        var topicName = document.getElementById("form-topic-name").value;
        var topicDescription = document.getElementById("form-topic-description").value;
        var topicMainInformation = document.getElementById("form-topic-main-information").value;

        var question1 = document.getElementById("form-question1").value;
        var answer1 = document.getElementById("form-answer1").value;
        var question2 = document.getElementById("form-question2").value;
        var answer2 = document.getElementById("form-answer2").value;
        var question3 = document.getElementById("form-question3").value;
        var answer3 = document.getElementById("form-answer3").value;
        var question4 = document.getElementById("form-question4").value;
        var answer4 = document.getElementById("form-answer4").value;
        var question5 = document.getElementById("form-question5").value;
        var answer5 = document.getElementById("form-answer5").value;
        var question6 = document.getElementById("form-question6").value;
        var answer6 = document.getElementById("form-answer6").value;

        console.log("topic_id:", topic_id);
        console.log("topicName:", topicName);
        console.log("topicDescription:", topicDescription);
        console.log("topicMainInformation:", topicMainInformation);
        console.log("question1:", question1);
        console.log("answer1:", answer1);
        console.log("question2:", question2);
        console.log("answer2:", answer2);
        console.log("question3:", question3);
        console.log("answer3:", answer3);
        console.log("question4:", question4);
        console.log("answer4:", answer4);
        console.log("question5:", question5);
        console.log("answer5:", answer5);
        console.log("question6:", question6);
        console.log("answer6:", answer6);

        const body_creatingTopic = {
            topic_id: topic_id,
            topic_name: topicName,
            topic_description: topicDescription,
            topic_main_information: topicMainInformation,
            topic_question_one: question1,
            topic_question_two: question2,
            topic_question_three: question3,
            topic_question_four: question4,
            topic_question_five: question5,
            topic_question_six: question6,
            topic_answer_one: answer1,
            topic_answer_two: answer2,
            topic_answer_three: answer3,
            topic_answer_four: answer4,
            topic_answer_five: answer5,
            topic_answer_six: answer6
        };

        fetch("http://localhost:3000/edittopicinformationandtest", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(body_creatingTopic)
        })
        .then(response => response.json())
        .then(data => {
            console.log(data);
            if (data.message === "Topic and test information updated successfully.") {
                var myModal = new bootstrap.Modal(document.getElementById('exampleModal'), {});
                myModal.show();
            } else {
                alert("An error occurred while updating the topic and test information.");
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while updating the topic and test information.');
        });
    }
</script>
</body>
</html>
